[
  
  {
    "title": "Practical Malware Analysis Lab 1-1",
    "url": "/posts/TEST/",
    "categories": "security, malware",
    "tags": "flarevm, remnux, malware analysis",
    "date": "2025-02-02 00:00:00 -0800",
    "content": "   For this lab we will be utilizing the files Lab01-01.exe and Lab01-01.dll located on our FlareVM machine at C:\\Users\\FlareVM\\Desktop\\Tools   Tools I will be using for this lab: PEid, PEviewer, Dependancy Walker, Strings  1. Upload the files to https://www.virustotal.com and view the reports. Does this file match any existing antivirus signatures?  Pulling the hash of one file can be done with the following command in PowerShell  Get-FileHash -Path \"C:\\path\\to\\the\\file.ext\" -Algorithm [AlgorithmName]   If you want to pull multiple files in one go, try this command:  Get-ChildItem -Path \"C:\\FolderName\" -Recurse -File | Get-FileHash -Algorithm [AlgorithmName] | Select-Object Hash, Path | Format-Table -AutoSize    The FlareVM setup I am running is completely isolated from the internet so I pulled the hashes from PEviewer.                 File       MD5       SHA256                       Lab01-01.exe       290934c61de9176ad682ffdd65f0a669       f50e42c8dfaab649bde0398867e930b86c2a599e8db83b8260393082268f2dba                 Lab01-01.dll       bb7425b82141a1c0f7d60e5106676bb1       58898bd42c5bd3bf9b1389f0eee5b39cd59180e8370eb9ea838a0b327bd6fe47           2. When were these files compiled?   pestudio view of compile timestamp for .exe file   pestudio view of compile timestamp for .dll file  3. Are there any indications that either of these files are packed or obfuscated? If so, what are the indicators?  4. Do any imports hint at what this malware does? If so, which imports are they?  5. Are there any host based indicators that you could look for on infected systems?  6. What network-based indicators could be used to find this malware on infected machines?  The strings for the .dll file show an IP address:   pestudio view of network-based indicator from .dll file  7. What would you guess is the purpose of these files?  Here is what we know the .exe does from strings and imports:  UnmapViewOfFile - Unmaps a mapped view of a file from the calling processâ€™ address space. Unmapping a mapped view of a file invalidates the range occupied by the view in the address space and makes the range available for other allocations.  MapViewOfFile - Maps a view of a file mapping into the address space of the calling process. Mapping a file makes the specified portion of the file visible in the address space of the calling process.  FindNextFileA - Continues a file search from a previous call to the FindFirstFile  FindFirstFileA - Searches a directory for a file or subdirectory with a name that matches a specific name (or partial name if wildcards are used.)  CopyFileA  CloseHandle  IsBadReadPtr  CreateFileMappingA -  CreateFileA -  FindClose - Closes the search handle created by FindFirstFileA/utilized by FindNextFileA.  Here is what we know the .dll does: "
  }
  
]

