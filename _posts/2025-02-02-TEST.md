---
title: Practical Malware Analysis Lab 1-1 [Working Draft - Better Images Incoming]
date: 2025-02-02
categories: [security, malware]
tags: [flarevm, remnux, malware analysis]		#TAG names should always be lowercase
---

> For this lab we will be utilizing the files Lab01-01.exe and Lab01-01.dll located on our FlareVM machine at `C:\Users\FlareVM\Desktop\Tools`
{: .prompt-info}

Tools I will be using for this lab: PEid, PEviewer, Dependancy Walker, Strings

### 1. Upload the files to <https://www.virustotal.com> and view the reports. Does this file match any existing antivirus signatures? 

Pulling the hash of one file can be done with the following command in PowerShell

```powershell
Get-FileHash -Path "C:\path\to\the\file.ext" -Algorithm [AlgorithmName]
```

If you want to pull multiple files in one go, try this command:

```powershell
Get-ChildItem -Path "C:\FolderName" -Recurse -File | Get-FileHash -Algorithm [AlgorithmName] | Select-Object Hash, Path | Format-Table -AutoSize 
```


The FlareVM setup I am running is completely isolated from the internet so I pulled the hashes from PEviewer.



| File         | MD5                              | SHA256
| :----------- | :------------------------------- | :--------------------------------------------------------------- |
| Lab01-01.exe | 290934c61de9176ad682ffdd65f0a669 | f50e42c8dfaab649bde0398867e930b86c2a599e8db83b8260393082268f2dba |
| Lab01-01.dll | bb7425b82141a1c0f7d60e5106676bb1 | 58898bd42c5bd3bf9b1389f0eee5b39cd59180e8370eb9ea838a0b327bd6fe47 |  


Virus Total lists the .exe as trojan.skeeyah/waski and .dll as trojan.ulise/aenjaris.
	


### 2. When were these files compiled?

![Lab-01-01.exe compile date](/post_content/PMA/Lab%201/exe_compile_timestamp.png)
_pestudio view of compile timestamp for .exe file_

![Lab-01-01.dll compile date](/post_content/PMA/Lab%201/dll_compile_timestamp.png)
_pestudio view of compile timestamp for .dll file_



### 3. Are there any indications that either of these files are packed or obfuscated? If so, what are the indicators?

`For the .dll and .exe there is no evidence that these files were packed if we look at the file in PEstudio under the "file > signature" section. In this case, Microsoft Linker/Visual Studio 6.0/Microsoft Visual C++`

### 4. Do any imports hint at what this malware does? If so, which imports are they?

`CopyFileA, FindNextFileA, FindFirstFileA. From first glance the program is looking for files to copy.`

### 5. Are there any host based indicators that you could look for on infected systems?

`The .exe contains a reference to a created file called kerne132.dll. Sneaky!`

### 6. What network-based indicators could be used to find this malware on infected machines?

The strings for the .dll file show an IP address:

![Lab-01-01.dll netowrk-based indicator](/post_content/PMA/Lab%201/dll_network_indicator.png)
_pestudio view of network-based indicator from .dll file_


### 7. What would you guess is the purpose of these files?

Here is what we know the .exe does from strings and imports based on Windows API documentation:

- UnmapViewOfFile - Unmaps a mapped view of a file from the calling process' address space. Unmapping a mapped view of a file invalidates the range occupied by the view in the address space and makes the range available for other allocations.


- MapViewOfFile - Maps a view of a file mapping into the address space of the calling process. Mapping a file makes the specified portion of the file visible in the address space of the calling process.


- FindNextFileA - Continues a file search from a previous call to the FindFirstFile.


- FindFirstFileA - Searches a directory for a file or subdirectory with a name that matches a specific name or partial name if wildcards are used.


- CopyFileA - Copies and existing file to a new file.


- CloseHandle - Closes an open object handle (ex. Event, File, File mapping).


- IsBadReadPtr - Verifies that the calling process has read access to the specified range of memory.


- CreateFileMappingA - Creates or opens a named or unnamed file mapping for a specified file.


- CreateFileA - Creates or opens a file or I/O device.


- FindClose - Closes the search handle created by FindFirstFileA/utilized by FindNextFileA.


Here is what we know the .dll does:
`.dll imports placeholder`
- CreateMutexA
- CreateProcessA
- OpenMutexA
- Sleep
